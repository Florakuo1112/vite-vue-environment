import{_ as g,D as b,o as a,c as l,a as e,t as r,b as k,F as h,u as _,x as m,J as w,m as M,d as u,y as L,H as $,K as C,r as p}from"./index-BvTcxZWB.js";import{p as O}from"./PaginationView-f3RnhuSh.js";import{b as I}from"./bootstrap.min-Bxag7N4e.js";import{c as S}from"./checkLogin-BdxS32oh.js";const V="https://vue3-course-api.hexschool.io/v2",T="hogwarts",D={props:["getItem","pages"],data(){return{orderModal:null,currentOrder:{id:"",is_paid:!1,user:{name:"",address:""}},house:["Gryffindor","Hufflepuff","Ravenclaw","Slytherin"],total:0}},methods:{modalShow(n){this.currentOrder={...n},console.log(this.currentOrder),this.total=this.currentOrder.total,this.orderModal.show()},save(n){console.log(this.currentOrder);let s=this.currentOrder;b.put(`${V}/api/${T}/admin/order/${n}`,{data:s}).then(c=>{console.log(c),this.orderModal.hide(),alert(c.data.message),this.getItem(this.pages.current_page)}).catch(c=>{console.log(c)})}},mounted(){this.orderModal=new I.Modal(this.$refs.orderModal,{keyboard:!1,backdrop:"static"}),console.log(this.pages)}},E={class:"modal fade",tabindex:"-1",ref:"orderModal","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},H={class:"modal-dialog"},N={class:"modal-content"},U=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"學生選課資訊"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),z={class:"modal-body"},B={class:"mb-3"},R={class:"mb-3"},j={class:"mb-3"},A={class:"mb-3"},F={class:"mb-3"},G={class:"form-check"},P=e("label",{class:"form-check-label",for:"flexCheckChecked"}," 付款 ",-1),J={class:"modal-footer"},K=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function q(n,s,c,f,t,d){return a(),l("div",E,[e("div",H,[e("div",N,[U,e("div",z,[e("div",B," 訂單ID: "+r(t.currentOrder.id),1),e("div",R," 學生姓名: "+r(t.currentOrder.user.name),1),e("div",j," 學院: "+r(t.currentOrder.user.address),1),e("div",A,[k(" 已選課程: "),e("ul",null,[(a(!0),l(h,null,_(t.currentOrder.products,i=>(a(),l("li",{key:i.id},r(i.product.title)+" / "+r(i.id),1))),128))])]),e("div",F," Galleon: "+r(this.total),1),e("div",G,[m(e("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckChecked","onUpdate:modelValue":s[0]||(s[0]=i=>t.currentOrder.is_paid=i)},null,512),[[w,t.currentOrder.is_paid]]),P])]),e("div",J,[K,e("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=i=>d.save(t.currentOrder.id))},"Save Change")])])])],512)}const Q=g(D,[["render",q]]),W="https://vue3-course-api.hexschool.io/v2",X="hogwarts",Y={components:{pagination:O,orderModal:Q},data(){return{orderList:[],pages:{},isLoading:!0,search:"",filterStudents:[]}},methods:{getItem(n=1){b.get(`${W}/api/${X}/admin/orders?page=${n}`).then(s=>{console.log(s),this.orderList=s.data.orders,this.pages=s.data.pagination,this.isLoading=!1})},openModal(n){this.$refs.orderDetail.modalShow(n)}},computed:{...M(S,["isLogin"]),filterStudent(){return this.orderList.filter(n=>n.user.name.toLowerCase().match(this.search))}},mounted(){this.isLogin==!1?this.$router.push({name:"login"}):this.getItem()}},Z={class:"container vh-100"},ee={class:"d-flex mb-2 justify-content-lg-between flex-lg-row flex-column align-items-lg-center"},te=e("h1",{class:"pb-2 text-primary"},"學生選課資訊",-1),se={class:"dropdown col-lg-4 border border-primary rounded-pill d-flex align-items-center",style:{height:"40px"}},oe=e("i",{class:"fa-brands fa-searchengin ms-4",style:{"font-size":"24px"}},null,-1),re={class:"dropdown-menu w-75","aria-labelledby":"dropdownMenu2"},ne={key:0},ae=e("button",{class:"dropdown-item",disabled:""},"查無學生",-1),le=[ae],de=["onClick"],ie={class:"table table-warning h6 table-hover table-bordered border-primary"},ce=e("thead",null,[e("tr",null,[e("th",null,"學生"),e("th",null,"學院"),e("th",null,"是否註冊"),e("th",null,"訂單id")])],-1),he=["onClick"],ue={class:"col-3"},pe={class:"col-3"},_e={class:"col-3"},me={style:{"font-size":"12px"},class:"mb-0"},ge={class:"d-flex justify-content-center"};function be(n,s,c,f,t,d){const i=p("LaodingOverlay"),v=p("pagination"),y=p("orderModal");return a(),l(h,null,[u(i,{active:t.isLoading},null,8,["active"]),e("div",Z,[e("div",ee,[te,e("div",se,[oe,m(e("input",{class:"w-75 h-75",id:"dropdownMenu2","data-bs-toggle":"dropdown","aria-expanded":"false",style:{border:"none",height:"40px","background-color":"transparent"},placeholder:"查詢學生","onUpdate:modelValue":s[0]||(s[0]=o=>t.search=o)},null,512),[[L,t.search]]),m(e("ul",re,[d.filterStudent.length==0?(a(),l("li",ne,le)):C("",!0),(a(!0),l(h,null,_(d.filterStudent,o=>(a(),l("li",{key:o.user.name},[e("button",{class:"dropdown-item",type:"button",onClick:x=>d.openModal(o)},r(o.user.name)+" from "+r(o.user.address),9,de)]))),128))],512),[[$,t.search]])])]),e("table",ie,[ce,e("tbody",null,[(a(!0),l(h,null,_(t.orderList,o=>(a(),l("tr",{key:o.id,onClick:x=>d.openModal(o),style:{"font-size":"14px"}},[e("th",ue,r(o.user.name),1),e("th",pe,r(o.user.address),1),e("th",_e,r(o.is_paid?"已註冊":"未註冊"),1),e("th",null,[e("p",me,r(o.id),1)])],8,he))),128))])]),e("div",ge,[u(v,{pages:t.pages,getItem:d.getItem},null,8,["pages","getItem"])]),u(y,{ref:"orderDetail",getItem:d.getItem,pages:t.pages},null,8,["getItem","pages"])])],64)}const ke=g(Y,[["render",be]]);export{ke as default};
