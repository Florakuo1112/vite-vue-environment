import{_ as f,o as l,a as i,b as e,n as _,g as p,F as h,h as u,t as r,H as x,d as L,z as b,K as $,y as C,e as g,A as M,I as O,L as A,r as m}from"./index-BKKQqLik.js";import{b as P}from"./bootstrap.min-Dcp5m6Pb.js";import{c as V}from"./checkLogin-GQiCsjIL.js";const S={props:["pages","getAdminProductList"]},T={"aria-label":"Page navigation example"},E={class:"pagination"},I={class:"page-item"},z=e("span",{"aria-hidden":"true"},"«",-1),D=[z],N=["onClick"],H={class:"page-item"},U=e("span",{"aria-hidden":"true"},"»",-1),B=[U];function R(d,t,s,v,o,c){return l(),i("nav",T,[e("ul",E,[e("li",I,[e("a",{class:_(["page-link",{disabled:s.pages.has_pre==!1}]),href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=p(n=>s.getAdminProductList(s.pages.current_page-1),["prevent"]))},D,2)]),(l(!0),i(h,null,u(s.pages.total_pages,n=>(l(),i("li",{class:_(["page-item",{active:n==s.pages.current_page}]),key:n},[e("a",{class:"page-link",href:"#",onClick:p(k=>s.getAdminProductList(n),["prevent"])},r(n),9,N)],2))),128)),e("li",H,[e("a",{class:_(["page-link",{disabled:s.pages.has_next==!1}]),href:"#","aria-label":"Next",onClick:t[1]||(t[1]=p(n=>s.getAdminProductList(s.pages.current_page+1),["prevent"]))},B,2)])])])}const j=f(S,[["render",R]]),F="https://vue3-course-api.hexschool.io/v2",G="hogwarts",K={data(){return{orderModal:null,currentOrder:{id:"",is_paid:!1,user:{name:"",address:""}},house:["Gryffindor","Hufflepuff","Ravenclaw","Slytherin"],total:0}},methods:{modalShow(d){this.currentOrder={...d},console.log(this.currentOrder),this.total=this.currentOrder.total,this.orderModal.show()},save(d){console.log(this.currentOrder);let t=this.currentOrder;x.put(`${F}/api/${G}/admin/order/${d}`,{data:t}).then(s=>{console.log(s),this.orderModal.hide(),alert(s.data.message),window.location.reload()}).catch(s=>{console.log(s)})}},mounted(){this.orderModal=new P.Modal(this.$refs.orderModal,{keyboard:!1,backdrop:"static"})}},q={class:"modal fade",tabindex:"-1",ref:"orderModal","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},J={class:"modal-dialog"},Q={class:"modal-content"},W=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"學生選課資訊"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),X={class:"modal-body"},Y={class:"mb-3"},Z={class:"mb-3"},ee={class:"mb-3"},te={class:"mb-3"},se={class:"mb-3"},oe={class:"form-check"},ne=e("label",{class:"form-check-label",for:"flexCheckChecked"}," 付款 ",-1),ae={class:"modal-footer"},re=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function de(d,t,s,v,o,c){return l(),i("div",q,[e("div",J,[e("div",Q,[W,e("div",X,[e("div",Y," 訂單ID: "+r(o.currentOrder.id),1),e("div",Z," 學生姓名: "+r(o.currentOrder.user.name),1),e("div",ee," 學院: "+r(o.currentOrder.user.address),1),e("div",te,[L(" 已選課程: "),e("ul",null,[(l(!0),i(h,null,u(o.currentOrder.products,n=>(l(),i("li",{key:n.id},r(n.product.title)+" / "+r(n.id),1))),128))])]),e("div",se," Galleon: "+r(this.total),1),e("div",oe,[b(e("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckChecked","onUpdate:modelValue":t[0]||(t[0]=n=>o.currentOrder.is_paid=n)},null,512),[[$,o.currentOrder.is_paid]]),ne])]),e("div",ae,[re,e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=n=>c.save(o.currentOrder.id))},"Save Change")])])])],512)}const le=f(K,[["render",de]]),ie="https://vue3-course-api.hexschool.io/v2",ce="hogwarts",he={components:{pagination:j,orderModal:le},data(){return{orderList:[],pages:{},isLoading:!0,search:"",filterStudents:[]}},methods:{...C(V,["checkLogin"]),getAdminProductList(d=1){x.get(`${ie}/api/${ce}/admin/orders?page=${d}`).then(t=>{console.log(t),this.orderList=t.data.orders,this.pages=t.data.pagination,this.isLoading=!1})},openModal(d){this.$refs.orderDetail.modalShow(d)}},computed:{filterStudent(){return this.orderList.filter(d=>d.user.name.toLowerCase().match(this.search))}},mounted(){this.checkLogin(),this.getAdminProductList()}},ue={class:"bg-warning vh-100"},_e={class:"container"},pe={class:"d-flex justify-content-lg-between flex-lg-row flex-column align-items-lg-center"},ge=e("h1",{class:"pt-6 pb-2 text-primary"},"學生選課資訊",-1),me={class:"dropdown col-lg-4 border border-primary rounded-pill d-flex align-items-center",style:{height:"40px"}},be=e("i",{class:"fa-brands fa-searchengin ms-4",style:{"font-size":"24px"}},null,-1),fe={class:"dropdown-menu w-75","aria-labelledby":"dropdownMenu2"},ve={key:0},ke=e("button",{class:"dropdown-item",disabled:""},"查無學生",-1),xe=[ke],ye=["onClick"],we={class:"table table-warning h6 table-hover table-bordered border-primary"},Le=e("thead",null,[e("tr",null,[e("th",null,"學生"),e("th",null,"學院"),e("th",null,"是否註冊"),e("th",null,"訂單id")])],-1),$e=["onClick"],Ce={class:"col-3"},Me={class:"col-3"},Oe={class:"col-3"},Ae={style:{"font-size":"12px"},class:"mb-0"},Pe={class:"d-flex justify-content-center"};function Ve(d,t,s,v,o,c){const n=m("LaodingOverlay"),k=m("pagination"),y=m("orderModal");return l(),i("div",ue,[g(n,{active:o.isLoading},null,8,["active"]),e("div",_e,[e("div",pe,[ge,e("div",me,[be,b(e("input",{class:"w-75 h-75",id:"dropdownMenu2","data-bs-toggle":"dropdown","aria-expanded":"false",style:{border:"none",height:"40px","background-color":"transparent"},placeholder:"查詢學生","onUpdate:modelValue":t[0]||(t[0]=a=>o.search=a)},null,512),[[M,o.search]]),b(e("ul",fe,[c.filterStudent.length==0?(l(),i("li",ve,xe)):A("",!0),(l(!0),i(h,null,u(c.filterStudent,a=>(l(),i("li",{key:a.user.name},[e("button",{class:"dropdown-item",type:"button",onClick:w=>c.openModal(a)},r(a.user.name)+" from "+r(a.user.address),9,ye)]))),128))],512),[[O,o.search]])])]),e("table",we,[Le,e("tbody",null,[(l(!0),i(h,null,u(o.orderList,a=>(l(),i("tr",{key:a.id,onClick:w=>c.openModal(a),style:{"font-size":"14px"}},[e("th",Ce,r(a.user.name),1),e("th",Me,r(a.user.address),1),e("th",Oe,r(a.is_paid?"已註冊":"未註冊"),1),e("th",null,[e("p",Ae,r(a.id),1)])],8,$e))),128))])]),e("div",Pe,[g(k,{pages:o.pages,getAdminProductList:c.getAdminProductList,style:{position:"fixed",bottom:"50px"}},null,8,["pages","getAdminProductList"])]),g(y,{ref:"orderDetail"},null,512)])])}const Ie=f(he,[["render",Ve]]);export{Ie as default};
