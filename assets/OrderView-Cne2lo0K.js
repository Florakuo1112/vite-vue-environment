import{_ as b,o as i,c as l,a as e,n as _,f as p,F as u,g as h,t as a,G as y,b as $,z as f,K as w,m as C,d as m,A as M,I as P,L as A,r as g}from"./index-Bavkz2tH.js";import{b as O}from"./bootstrap.min-BX-e7Dm5.js";import{c as S}from"./checkLogin-zC808EN4.js";const V={props:["pages","getAdminProductList"]},T={"aria-label":"Page navigation example"},E={class:"pagination"},I={class:"page-item"},z=e("span",{"aria-hidden":"true"},"«",-1),D=[z],N=["onClick"],U={class:"page-item"},B=e("span",{"aria-hidden":"true"},"»",-1),G=[B];function H(d,t,s,v,o,c){return i(),l("nav",T,[e("ul",E,[e("li",I,[e("a",{class:_(["page-link",{disabled:s.pages.has_pre==!1}]),href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=p(n=>s.getAdminProductList(s.pages.current_page-1),["prevent"]))},D,2)]),(i(!0),l(u,null,h(s.pages.total_pages,n=>(i(),l("li",{class:_(["page-item",{active:n==s.pages.current_page}]),key:n},[e("a",{class:"page-link",href:"#",onClick:p(x=>s.getAdminProductList(n),["prevent"])},a(n),9,N)],2))),128)),e("li",U,[e("a",{class:_(["page-link",{disabled:s.pages.has_next==!1}]),href:"#","aria-label":"Next",onClick:t[1]||(t[1]=p(n=>s.getAdminProductList(s.pages.current_page+1),["prevent"]))},G,2)])])])}const R=b(V,[["render",H]]),j="https://vue3-course-api.hexschool.io/v2",F="hogwarts",K={props:["getAdminProductList"],data(){return{orderModal:null,currentOrder:{id:"",is_paid:!1,user:{name:"",address:""}},house:["Gryffindor","Hufflepuff","Ravenclaw","Slytherin"],total:0}},methods:{modalShow(d){this.currentOrder={...d},console.log(this.currentOrder),this.total=this.currentOrder.total,this.orderModal.show()},save(d){console.log(this.currentOrder);let t=this.currentOrder;y.put(`${j}/api/${F}/admin/order/${d}`,{data:t}).then(s=>{console.log(s),this.orderModal.hide(),alert(s.data.message),this.getAdminProductList()}).catch(s=>{console.log(s)})}},mounted(){this.orderModal=new O.Modal(this.$refs.orderModal,{keyboard:!1,backdrop:"static"})}},q={class:"modal fade",tabindex:"-1",ref:"orderModal","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},J={class:"modal-dialog"},Q={class:"modal-content"},W=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"學生選課資訊"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),X={class:"modal-body"},Y={class:"mb-3"},Z={class:"mb-3"},ee={class:"mb-3"},te={class:"mb-3"},se={class:"mb-3"},oe={class:"form-check"},ne=e("label",{class:"form-check-label",for:"flexCheckChecked"}," 付款 ",-1),re={class:"modal-footer"},ae=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function de(d,t,s,v,o,c){return i(),l("div",q,[e("div",J,[e("div",Q,[W,e("div",X,[e("div",Y," 訂單ID: "+a(o.currentOrder.id),1),e("div",Z," 學生姓名: "+a(o.currentOrder.user.name),1),e("div",ee," 學院: "+a(o.currentOrder.user.address),1),e("div",te,[$(" 已選課程: "),e("ul",null,[(i(!0),l(u,null,h(o.currentOrder.products,n=>(i(),l("li",{key:n.id},a(n.product.title)+" / "+a(n.id),1))),128))])]),e("div",se," Galleon: "+a(this.total),1),e("div",oe,[f(e("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckChecked","onUpdate:modelValue":t[0]||(t[0]=n=>o.currentOrder.is_paid=n)},null,512),[[w,o.currentOrder.is_paid]]),ne])]),e("div",re,[ae,e("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=n=>c.save(o.currentOrder.id))},"Save Change")])])])],512)}const ie=b(K,[["render",de]]),le="https://vue3-course-api.hexschool.io/v2",ce="hogwarts",ue={components:{pagination:R,orderModal:ie},data(){return{orderList:[],pages:{},isLoading:!0,search:"",filterStudents:[]}},methods:{getAdminProductList(d=1){y.get(`${le}/api/${ce}/admin/orders?page=${d}`).then(t=>{console.log(t),this.orderList=t.data.orders,this.pages=t.data.pagination,this.isLoading=!1})},openModal(d){this.$refs.orderDetail.modalShow(d)}},computed:{...C(S,["isLogin"]),filterStudent(){return this.orderList.filter(d=>d.user.name.toLowerCase().match(this.search))}},mounted(){this.isLogin==!1?this.$router.push({name:"login"}):this.getAdminProductList()}},he={class:"container vh-100"},_e={class:"d-flex mb-2 justify-content-lg-between flex-lg-row flex-column align-items-lg-center"},pe=e("h1",{class:"pb-2 text-primary"},"學生選課資訊",-1),me={class:"dropdown col-lg-4 border border-primary rounded-pill d-flex align-items-center",style:{height:"40px"}},ge=e("i",{class:"fa-brands fa-searchengin ms-4",style:{"font-size":"24px"}},null,-1),fe={class:"dropdown-menu w-75","aria-labelledby":"dropdownMenu2"},be={key:0},ve=e("button",{class:"dropdown-item",disabled:""},"查無學生",-1),xe=[ve],ye=["onClick"],ke={class:"table table-warning h6 table-hover table-bordered border-primary"},Le=e("thead",null,[e("tr",null,[e("th",null,"學生"),e("th",null,"學院"),e("th",null,"是否註冊"),e("th",null,"訂單id")])],-1),$e=["onClick"],we={class:"col-3"},Ce={class:"col-3"},Me={class:"col-3"},Pe={style:{"font-size":"12px"},class:"mb-0"},Ae={class:"d-flex justify-content-center"};function Oe(d,t,s,v,o,c){const n=g("LaodingOverlay"),x=g("pagination"),k=g("orderModal");return i(),l(u,null,[m(n,{active:o.isLoading},null,8,["active"]),e("div",he,[e("div",_e,[pe,e("div",me,[ge,f(e("input",{class:"w-75 h-75",id:"dropdownMenu2","data-bs-toggle":"dropdown","aria-expanded":"false",style:{border:"none",height:"40px","background-color":"transparent"},placeholder:"查詢學生","onUpdate:modelValue":t[0]||(t[0]=r=>o.search=r)},null,512),[[M,o.search]]),f(e("ul",fe,[c.filterStudent.length==0?(i(),l("li",be,xe)):A("",!0),(i(!0),l(u,null,h(c.filterStudent,r=>(i(),l("li",{key:r.user.name},[e("button",{class:"dropdown-item",type:"button",onClick:L=>c.openModal(r)},a(r.user.name)+" from "+a(r.user.address),9,ye)]))),128))],512),[[P,o.search]])])]),e("table",ke,[Le,e("tbody",null,[(i(!0),l(u,null,h(o.orderList,r=>(i(),l("tr",{key:r.id,onClick:L=>c.openModal(r),style:{"font-size":"14px"}},[e("th",we,a(r.user.name),1),e("th",Ce,a(r.user.address),1),e("th",Me,a(r.is_paid?"已註冊":"未註冊"),1),e("th",null,[e("p",Pe,a(r.id),1)])],8,$e))),128))])]),e("div",Ae,[m(x,{pages:o.pages,getAdminProductList:c.getAdminProductList,style:{position:"fixed",bottom:"50px"}},null,8,["pages","getAdminProductList"])]),m(k,{ref:"orderDetail",getAdminProductList:c.getAdminProductList},null,8,["getAdminProductList"])])],64)}const Ee=b(ue,[["render",Oe]]);export{Ee as default};
